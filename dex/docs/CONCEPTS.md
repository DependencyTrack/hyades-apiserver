# Concepts

## Durable Execution

Durable execution is a programming model where the state and progress of (potentially long-running)
processes is automatically persisted, enabling them to survive failures and restarts.

> [!NOTE]
> Because dex is heavily influenced by [Temporal], it has adopted most of its concepts and wording.
> Some concepts may have different names in other engines, e.g. Durable Task uses *orchestration*
> instead of *workflow*.

Like [Temporal], dex records every completed step of a [workflow](#workflow) as an event in the database.
If a process crashes or is restarted, the workflow automatically resumes from where it left off
by replaying its event history. This makes workflows resilient without requiring manual
work to implement state management or retry logic.

Durable execution ensures that once a workflow is started, it will run to completion,
even when experiencing repeated transient failures.

## Workflow

A workflow is the formal description of a sequence of steps to execute.

Following [Temporal]'s example, dex workflows are defined as normal application code.
Workflow code must be *deterministic and free of side effects* to enable reliable history replay.
Its sole purpose is orchestration, i.e. the sequencing and coordination of work, not performing it directly.

Workflows can invoke [activities](#activity), create [timers](#timer), spawn child workflows,
and wait for [external events](#external-event).

## Workflow Instance

A workflow instance is a specific instantiation of a [workflow](#workflow).

Instances can be executed multiple times, but only a single execution
in non-terminal state can exist at any given point in time.

In dex, instances are identified by an *instance ID*, which is defined by clients when starting a workflow.

## Workflow Run

A workflow run is a single execution of a [workflow instance](#workflow-instance).

Each run has a unique identifier and maintains a complete event history that captures
the steps executed so far. The history enables replay for recovery, debugging,
and ensuring deterministic behavior.

Workflow runs can carry metadata such as labels, priority, and a custom status.

## Activity

An activity is the formal description of a non-deterministic operation. It is where interactions with
external systems, and more generally I/O, is intended to happen.

Execution of activities happens asynchronously from their "owning" workflow's execution, making it non-blocking.

In practice, activity invocations behave similar to conventional background jobs.

Activities are anticipated to fail, and will be transparently retried. Retry behaviour is
customizable using retry policies, on a per-invocation basis.

Because activities may be executed multiple times as part of the retry mechanism,
they should be idempotent.

## Timer

A timer provides durable delays within a workflow execution.

Unlike regular sleeps, timers are recorded in the workflow run's event history,
making them deterministic and replay-safe.

## External Event

An external event is a message sent to a workflow run from outside the dex engine.

External events enable workflows to pause and wait for signals from external systems or users,
such as approval notifications, webhook callbacks, or status updates. Each event has a unique
identifier and can carry optional payload data.

## Task

A task is a unit of work generated by the dex engine to drive progress of either
a [workflow run](#workflow-run) or an [activity](#activity).

Tasks are scheduled for execution on [task queues](#task-queue),
from where they're picked up by [task workers](#task-worker).

## Task Queue

A task queue is a named queue where [tasks](#task) are scheduled for execution.

Task queues organize and distribute work to [workers](#task-worker). Each queue has a type (*workflow* or *activity*)
and tracks its capacity and current depth (number of pending tasks). Workflows and activities
specify which queue their tasks should be routed to.

Queues enable separation of concerns, allowing different workers to specialize in different
types of work and providing resource isolation between workloads.

> [!NOTE]
> In dex, queues further act as a means to scale, as each task queue
> is stored in a separate physical table [partition](https://www.postgresql.org/docs/current/ddl-partitioning.html#DDL-PARTITIONING-OVERVIEW).

The capacity of a queue is modifiable at runtime, allowing administrators to throttle
task execution globally for an entire cluster. It is further possible to *pause* queues entirely.

## Task Worker

A task worker is a component that polls tasks from a queue, and executes them.

Workers can either process workflow tasks, *or* activity tasks, but not both.
Each worker polls from *exactly one* [task queue](#task-queue).

[Temporal]: https://github.com/temporalio/temporal