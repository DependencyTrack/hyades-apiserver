/*
 * This file is part of Dependency-Track.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * SPDX-License-Identifier: Apache-2.0
 * Copyright (c) OWASP Foundation. All Rights Reserved.
 */
package org.dependencytrack.model;

import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.Test;

public class VulnerabilityAliasTest {

    @Test
    public void testCopyFieldsFrom() {
        var alias = new VulnerabilityAlias();
        alias.setCveId("someCveId");
        alias.setSonatypeId("someSonatypeId");
        alias.setGhsaId("someGhsaId");
        alias.setOsvId("someOsvId");
        alias.setSnykId("someSnykId");
        alias.setGsdId("someGsdId");
        alias.setVulnDbId("someVulnDbId");
        alias.setInternalId("someInternalId");

        var other = new VulnerabilityAlias();
        other.setCveId("anotherCveId");
        other.setSonatypeId("anotherSonatypeId");
        other.setGhsaId("anotherGhsaId");
        other.setOsvId("anotherOsvId");
        other.setSnykId("anotherSnykId");
        other.setGsdId("anotherGsdId");
        other.setInternalId("anotherInternalId");
        other.setVulnDbId(null);

        alias.copyFieldsFrom(other);

        Assertions.assertEquals(other.getCveId(), alias.getCveId());
        Assertions.assertEquals(other.getSonatypeId(), alias.getSonatypeId());
        Assertions.assertEquals(other.getGhsaId(), alias.getGhsaId());
        Assertions.assertEquals(other.getOsvId(), alias.getOsvId());
        Assertions.assertEquals(other.getSnykId(), alias.getSnykId());
        Assertions.assertEquals(other.getGsdId(), alias.getGsdId());
        Assertions.assertEquals(other.getInternalId(), alias.getInternalId());

        // null does not overwrite existing value
        Assertions.assertEquals(alias.getVulnDbId(), alias.getVulnDbId());
    }
}
