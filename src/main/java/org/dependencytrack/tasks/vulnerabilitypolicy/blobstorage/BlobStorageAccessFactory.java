package org.dependencytrack.tasks.vulnerabilitypolicy.blobstorage;

import alpine.Config;
import org.dependencytrack.common.ConfigKey;

import javax.naming.OperationNotSupportedException;

public class BlobStorageAccessFactory {

    public static BlobStorageAccessHandler createStorageHandler() throws OperationNotSupportedException {
        if (Config.getInstance().getProperty(ConfigKey.VULNERABILITY_POLICY_BUNDLE_SOURCE_TYPE).equalsIgnoreCase("NGINX")) {
            return new NginxStorageHandler();
        } else if (Config.getInstance().getProperty(ConfigKey.VULNERABILITY_POLICY_BUNDLE_SOURCE_TYPE).equalsIgnoreCase("s3")) {
            return new S3StorageHandler();
        }
        throw new OperationNotSupportedException("The provided storage handler is currently not supported");
    }
}
