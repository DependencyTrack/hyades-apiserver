package org.dependencytrack.tasks.vulnerabilitypolicy;


import org.dependencytrack.model.VulnerabilityPolicy;
import org.dependencytrack.persistence.QueryManager;
import org.projectnessie.cel.tools.ScriptCreateException;
import org.projectnessie.cel.tools.ScriptException;

import java.io.IOException;
import java.util.List;

public interface BlobStorageAccessHandler {

    boolean verifyDownloadNeeded() throws IOException;

    void downloadAndparseZippedContent() throws IOException, ScriptCreateException;

    void parseVulnerabilityPolicy(StringBuilder out, List<VulnerabilityPolicy> createVulnerabilityPolicyList,
                                     List<VulnerabilityPolicy> updateVulnerabilityPolicyList, List<String> policyNames) throws ScriptException, IOException;


    void saveParsedVulnerabilities(QueryManager queryManager, List<VulnerabilityPolicy> createVulnerabilityPolicyList,
                                   List<VulnerabilityPolicy> updateVulnerabilityPolicyList,
                                   List<String> policyNames);
}
